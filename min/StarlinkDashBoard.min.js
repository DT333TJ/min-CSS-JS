!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.StarlinkDashBoard=t():e.StarlinkDashBoard=t()}(self,(function(){return(()=>{"use strict";var e={129:(e,t,r)=>{r.r(t)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{var e=n;function t(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.default=void 0,r(129);var c=document.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),u=document.documentElement.clientWidth,h=document.documentElement.clientHeight,f=-1!==location.href.indexOf("taikang")?"http://10.132.23.192/starlinkdashboard":"http://10.154.31.90/starlinkdashboard";function m(e){document.querySelector("#starlinkdashboard-iframe-container").setAttribute("style",{true:"left: 0",false:"left: 100%"}[e]),document.querySelector("#dashboard-iframe-close-btn").setAttribute("style",{true:"visibility: visible",false:"visibility: hidden"}[e])}function b(e,t){for(var r=e.substring(e.indexOf("?")+1).split("&"),n=0;n<r.length;n++){var a=r[n].split("=");if(a[0]===t)return a[1]}}var p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,e),this.options=i({systemCode:"",title:"星链看板",commonOriSelfPageJump:"_blank",commonOriOtherPageJump:"_blank"},t),this.storageFlag=!1,this.initFlag=!1,this.openStatus=!1,this.openDrawer=this.openDrawer.bind(this),this.closeDrawer=this.closeDrawer.bind(this),this.onMessageHandle=this.onMessageHandle.bind(this),this.onVisibilityChangeHandle=this.onVisibilityChangeHandle.bind(this),this.init()}var r,n;return r=e,(n=[{key:"init",value:function(){this.bind();var e=f+"/starlinkEntry/starlinkEntry.css",t=this.options,r=t.systemCode,n=t.title;r?this.initEntryElement(e,n):window.alert("星链看板初始化不成功，缺少系统编码参数")}},{key:"bind",value:function(){window.addEventListener("message",this.onMessageHandle,!1),document.addEventListener("visibilitychange",this.onVisibilityChangeHandle)}},{key:"initEntryElement",value:function(e,r){var n=this;[{createEle:"link",targetEle:"head",attribute:{rel:"stylesheet",type:"text/css",href:e}},{createEle:"div",targetEle:"body",attribute:{id:"starlinkdashboard-iframe-container",className:"dashboard-iframe-containerClass",style:"visibility: hidden"}},{createEle:"span",targetEle:"#starlinkdashboard-iframe-container",attribute:{id:"dashboard-iframe-close-btn",className:"dashboard-iframe-close-btn",title:"关闭".concat(r),innerText:"✖",style:"visibility: hidden"},handleName:"iframeButtonHandle"},{createEle:"div",targetEle:"#starlinkdashboard-iframe-container",attribute:{id:"starlinkdashboard-iframe-widget",width:"0",height:"100%"}}].map(function(e){t(this,n),this.insertElement(e)}.bind(this))}},{key:"insertElement",value:function(e){var r=this,n=e.createEle,a=e.targetEle,i=e.attribute,o=e.handleName,s=document.createElement(n);i&&Object.keys(i).map(function(e){t(this,r),s[e]=i[e]}.bind(this)),document.querySelector(a).appendChild(s),o&&this.handleEvent(s,o)}},{key:"handleEvent",value:function(e,t){"iframeButtonHandle"===t&&this.iframeButtonHandle(e)}},{key:"iframeButtonHandle",value:function(e){var r=this;e.onclick=function(e){t(this,r),e.preventDefault(),this.closeDrawer()}.bind(this)}},{key:"closeDrawer",value:function(){m("false"),document.querySelector("#starlinkdashboard-iframe-widget").innerHTML="",sessionStorage.removeItem("starlinkdashboard-storage-urls"),this.openStatus=!1,this.initFlag=!1}},{key:"openDrawer",value:function(e){if(!this.openStatus){var t=function(e){for(var t="",r=0,n=Object.entries(e);r<n.length;r++){var a=(s=n[r],l=2,function(e){if(Array.isArray(e))return e}(s)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(s,l)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(s,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],o=a[1];t+="".concat(i,"=").concat(o,"&")}var s,l;return t}(e.params),r=this.options.systemCode,n=(-1!==location.href.indexOf("taikang")?"http://oa.taikang.com/starlinkdashboard":"http://oa.tkuat.com/starlinkdashboard")+"/".concat(r,"/dashboard?").concat(t)+"currentDashboard=".concat(r,"&oriDashboard=").concat(r,"&storageID=").concat((new Date).valueOf(),"&storageIndex=0");this.initIframeElementAndUrl(n),this.openStatus||(m("true"),this.openStatus=!0)}}},{key:"initIframeElementAndUrl",value:function(e){var r=this;document.querySelector("#starlinkdashboard-iframe-widget").innerHTML="",e=e.endsWith("&")?e.substring(0,e.length-1):e;var n={createEle:"iframe",targetEle:"#starlinkdashboard-iframe-widget",attribute:{id:"starlinkdashboard-iframe",className:"dashboard-iframe-widgetClass",width:u+"px",height:h+"px",frameborder:"0",scrolling:"no",style:"border: none",seamless:"seamless",src:e}};this.insertElement(n),document.getElementById("starlinkdashboard-iframe").onload=function(){t(this,r),this.initFlag||(this.initFlag=!0)}.bind(this)}},{key:"postMessageHandle",value:function(e){e.targetOrigin=c,e.postMessageName="starlinkdashboard",document.getElementById("starlinkdashboard-iframe").contentWindow.postMessage(e,"*")}},{key:"onMessageHandle",value:function(e){var t=e.data;if(e.origin===t.targetOrigin&&"starlinkdashboard"===t.postMessageName){if("init"===t.postMessageType&&t.params){var r=t.params.url;this.storageUrl(r)}if("fallback"===t.postMessageType&&t.params){var n=t.params.url;this.initIframeElementAndUrl(n)}if("jumpDashboard"===t.postMessageType&&t.params){var a=t.params.url;this.initIframeElementAndUrl(a)}if("jumpOtherSystemPage"===t.postMessageType&&t.params){var i=t.params.url;"_blank"!==this.options.commonOriOtherPageJump&&this.closeDrawer(),window.open(i,this.options.commonOriOtherPageJump)}}}},{key:"storageUrl",value:function(e){var t=JSON.parse(sessionStorage.getItem("starlinkdashboard-storage-urls"))||{},r=b(e,"storageID")||"",n=b(e,"storageIndex")||"",a=t.urls||[];r&&(t.storageID!==r+""&&(t={}),t.storageID=r,n?a[n]=e:a.push(e),t.urls=a,sessionStorage.setItem("starlinkdashboard-storage-urls",JSON.stringify(t)),this.openStatus&&this.postMessageHandle({storage:!0,storageData:JSON.stringify(t)}))}},{key:"onVisibilityChangeHandle",value:function(e){"visible"===document.visibilityState&&this.openStatus&&this.postMessageHandle({refresh:!0}),"hidden"===document.visibilityState&&this.openStatus&&this.postMessageHandle({resetRefresh:!0})}}])&&l(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();e.default=p})(),n.default})()}));